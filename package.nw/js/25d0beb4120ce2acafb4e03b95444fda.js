'use strict';!function(require,directRequire){async function a(){return D.isGameApp()?void nw.Shell.openExternal('https://developers.weixin.qq.com/minigame/dev/index.html'):void nw.Shell.openExternal('https://developers.weixin.qq.com/miniprogram/dev/index.html')}function b(){G(m.closeProject())}function c(a){const b=global.contentWindow.document.activeElement;if('WEBVIEW'===b.tagName)'persist:editor'===b.getAttribute('partition')?d.sendMessage(I,J(a)):b.executeScript({code:`document.execCommand('${a}')`});else{let b;const c=H().window.mainWindow;if(c===f.MAIN_WINDOW_TYPE.WEB_DEBUGGER){const a=global.windowMap.get('WEB_DEBUGGER');b=a&&a.window.document}else if(c===f.MAIN_WINDOW_TYPE.DEV){const a=global.windowMap.get('MAIN');b=a&&a.window.document}else b=global.contentWindow.document;b&&b.execCommand(a)}}const d=require('./ff946754202ecf377034d29daac7c8d9.js'),e=require('./bc78839ccca8df9e5ceeb7fae11b7be2.js'),f=require('./56c390e04c10e91a4aa2a2c19d9a885d.js'),g=require('./0634ee2ebd3e560d9d4804ecc960160f.js'),h=require('./37d8b9297fb1bd87f9a3ac407b8006a0.js'),i=require('./1fcc6bd55b687d154a4247e57fe3011d.js'),j=require('./9c906d27ca74e18d0deaaa231e71fdfa.js'),k=require('./6ff091369f442a4678a2ed4a1f758495.js'),l=require('./a8c87029da0fa06e986298d447ab0fe2.js'),m=require('./cc2c2970ff81ae4a83123e81ee123da2.js'),n=require('./fc137838572a83604db39acff8e909e0.js'),o=require('./e98c60a262d8d98e69e574a9d12a21df.js'),p=require('./c4b43629b4de3d73a79d27fb0314f46a.js'),q=require('./ba23d8b47b1f4ea08b9fd49939b9443f.js'),r=require('./fb43c40eddf059d0b7fa2a00b42caa7a.js'),s=require('./db2217eb4cff896bdcbc50abe005058f.js'),t=require('./f171257bbcaef547a3cf27266ccb0db2.js'),u=require('./common/locales/index.js'),v=require('./15ba1827c7f6564a45df6bd44da3a977.js'),w=require('./e5184416014aff2809a9dee32cc447c8.js'),x=require('./dc59f57d54946e61d27c95ab24d8cb4f.js'),y=require('./eadce02c750c875a10680bcfedadec88.js'),z=require('./c4190a2430506f3602ca550e1e75d620.js'),A=require('./84b183688a46c9e2626d3e6f83365e13.js'),B=require('./9ebfd1a4a241684455002e8c6d889fd7.js'),C=require('./bc2b895ee57942c71d19191b1e204b79.js'),D=require('./3bfffbe88b3d923921f851c0697974fe.js'),E=require('path'),F=require('./da7c31daaf542cf1796023d8e344b98a.js'),G=e.dispatch.bind(e),H=e.getState.bind(e),I='EDITOR',J=(a)=>JSON.stringify({type:'COMMAND',command:a});module.exports={buildNpm:async function(){G(i.setConfirmInfo({show:!0,showConfirm:!1,showCancel:!1,content:u.config.BUILDING}));const a=H(),b=a.project.current,c=Date.now();let d,f=!1;try{const a=E.join(b.projectpath,'plugin'===b.compileType?b.pluginRoot||'':b.miniprogramRoot||''),c=H().project.current;d=await C(a)}catch(a){console.error(a),f=!0,G(i.setConfirmInfo({show:!0,showConfirm:!0,showCancel:!1,content:u.config.ERROR_OCCURRED+'\n'+(a&&a.toString()||a)+(a.stack||'')}))}f||(d?G(i.setConfirmInfo({show:!0,showConfirm:!0,confirmText:u.config.CONFIRM,content:[u.config.BUILD_TIMEOUT.format(Date.now()-c)+'\n',...(d||[]).map((a,b)=>{const c='number'==typeof a.startLine?`${a.jsPath}:${a.startLine}-${a.endLine}`:a.jsPath;return`${b+1}. ${c}: ${a.msg}`})].join('\n')})):G(i.setConfirmInfo({show:!0,showConfirm:!0,showCancel:!0,content:u.config.NOT_FOUND_NODE_MODULES,confirmText:u.config.READ_DOCUMENTATION,callback:async(a)=>{a&&nw.Shell.openExternal('https://developers.weixin.qq.com/miniprogram/dev/devtools/npm.html')}})))},about:function(){nw.Shell.openExternal('https://developers.weixin.qq.com/miniprogram/dev/devtools/devtools.html')},checkUpdate:async function(){await x.refresh();w.resetAlreadyNotify();const a=await w.checkNeedUpdate();a?G(i.showError(u.config.APP_NEED_UPDATE.format(a))):G(i.showConfirmPopup({id:u.config.APP_NEED_NOT_UPDATE.format(global.appVersion),title:u.config.APP_NEED_NOT_UPDATE.format(global.appVersion),showCancel:!1,enableSelected:!0}))},helpAndFeedback:function(){a()},switchAccount:function(){G(j.loginExpired())},inspectApp:function(){global.isDevWindow?global.Win.showDevTools():chrome.developerPrivate.openDevTools({renderViewId:-1,renderProcessId:-1,extensionId:chrome.runtime.id})},inspectEditor:function(){for(const[a,b]of global.windowMap){const a=b.window.document.querySelector('webview[partition="persist:editor"]');a&&a.showDevTools(!0)}},inspectGitManager:function(){for(const[a,b]of global.windowMap){const a=b.window.document.querySelector('webview[data-plugin-id="gitmanager"]');if(a){a.showDevTools(!0);break}}},Doc:a,BBS:async function(a,b=f.IDE_SCENE.MENU_BAR){const c=D.isGameApp();try{const{resp:d,body:e}=await v({url:`${t.getBbsTicket}?idescene=${b}`,needToken:1}),f=e.open_ticket;f&&(a?-1<a.indexOf('?')?nw.Shell.openExternal(`${a}&devcode=${f}&idescene=${b}`):nw.Shell.openExternal(`${a}?devcode=${f}&idescene=${b}`):c?nw.Shell.openExternal(`https://developers.weixin.qq.com/community/minigame?devcode=${f}&idescene=${b}`):nw.Shell.openExternal(`https://developers.weixin.qq.com/community/develop?devcode=${f}&idescene=${b}`))}catch(a){c?nw.Shell.openExternal('https://developers.weixin.qq.com/community/minigame'):nw.Shell.openExternal('https://developers.weixin.qq.com/community/develop')}},exit:function(){A.quit()},newFile:function(){d.sendMessage(I,J('newFile'))},save:function(){d.sendMessage(I,J('save'))},saveAll:function(){d.sendMessage(I,J('saveAll'))},closeFile:function(){d.sendMessage(I,J('closeFile'))},newProject:function(){const a=H();a.window.mainWindow===f.MAIN_WINDOW_TYPE.DEV?B.createProjectOpen():a.window.mainWindow===f.MAIN_WINDOW_TYPE.ENTRANCE&&G(l.setEntrance({[a.window.entrance.tab]:{mode:'create'}}))},importProject:function(){const a=H();a.window.mainWindow===f.MAIN_WINDOW_TYPE.DEV?B.createProjectOpen('import'):a.window.mainWindow===f.MAIN_WINDOW_TYPE.ENTRANCE&&G(l.setEntrance({[a.window.entrance.tab]:{mode:'import'}}))},viewProjects:function(){const a=H();a.window.mainWindow===f.MAIN_WINDOW_TYPE.DEV?B.selectProjectOpen():a.window.mainWindow===f.MAIN_WINDOW_TYPE.ENTRANCE&&G(l.setEntrance({[a.window.entrance.tab]:{mode:'select'}}))},newMiniCode:function(){global.isDevWindow?B.createMiniCodeOpen('create'):G(l.setEntrance({tab:'minicode',minicode:{mode:'create'}}))},importMiniCode:function(){global.isDevWindow?B.createMiniCodeOpen('import'):G(l.setEntrance({tab:'minicode',minicode:{mode:'import'}}))},openProject:function(a){const b=H().project.current;if(b&&b.projectid===a)return;let c=a.split('_')[1];c=c&&decodeURIComponent(c)||'',B.openProject(a)},closeProject:b,openAppearanceSettings:function(){G(o.openIDESettings('appearance'))},openShortcutSettings:function(){G(o.openIDESettings('shortcut'))},openEditSettings:function(){G(o.openIDESettings('edit'))},openProxySettings:function(){G(o.openIDESettings('proxy'))},openNotificationSettings:function(){G(o.openIDESettings('notification'))},openSecuritySettings:function(){G(o.openIDESettings('security'))},openProjectSettings:function(){G(n.toggleClickKey(y.PROJECTINFO)),G(i.setProjectInfo({selected:'setting'}))},gotoFile:function(){d.sendMessage(I,J('gotoFile'))},gotoRecentFile:function(){d.sendMessage(I,J('gotoRencentFile'))},gotoPreviousEditor:function(){d.sendMessage(I,J('gotoPreviousEditor'))},gotoNextEditor:function(){d.sendMessage(I,J('gotoNextEditor'))},rebuild:function(){G(q.compile({origin:f.COMPILE_ORIGIN.SHORT_CUT}))},customRebuild:function(a){G(m.selectCompileCondiction(a)),G(q.compile({origin:f.COMPILE_ORIGIN.SHORT_CUT}))},openBuildSettings:function(){},toggleForegroundBackgroundStatus:function(){G(q.toggleBackground())},clearFileCache:function(){G(n.cleanFileCache())},clearAuthCache:function(){G(n.clearAuth())},clearStorageCache:function(){G(n.cleanStorageCache())},preview:function(){const a=H();let b=!1;try{b=a.settings.compiler.autoPreview}catch(a){}b?G(n.autoPreview()):G(n.togglePreviewCode())},upload:function(){G(n.toggleClickKey(y.NONE)),G(i.setUploadInfo({show:!0}))},customAnalysis:function(){G(k.openCustomAnalysis())},autoTest:function(){G(k.openMobileTest())},openProjectDetailInformation:function(){G(n.toggleClickKey(y.PROJECTINFO))},toggleFileTree:function(){d.sendMessage(I,J('toggleFileTree'))},focusDebugWindow:function(){},toggleSimulatorWindow:function(){G(l.toggleSimulatorWindow())},toggleSimulatorPopup:function(){G(l.toggleSimulatorPopup()),G(q.compile())},moveSimulatorLeft:function(){G(l.setSimulator({position:'left'}))},moveSimulatorRight:function(){G(l.setSimulator({position:'right'}))},toggleEditorWindow:function(){G(l.toggleEditorWindow())},undo:function(){c('undo')},redo:function(){c('redo')},copy:function(){c('copy')},cut:function(){c('cut')},paste:function(){c('paste')},unindent:function(){d.sendMessage(I,J('unindent'))},indent:function(){d.sendMessage(I,J('indent'))},format:function(){d.sendMessage(I,J('format'))},moveLineUp:function(){d.sendMessage(I,J('moveLinesUp'))},moveLineDown:function(){d.sendMessage(I,J('moveLinesDown'))},copyLineUp:function(){d.sendMessage(I,J('copyLinesUp'))},copyLineDown:function(){d.sendMessage(I,J('copyLinesDown'))},find:function(){d.sendMessage(I,J('find'))},findInFiles:function(){d.sendMessage(I,J('findInFiles'))},replace:function(){d.sendMessage(I,J('replace'))},collapseAll:function(){d.sendMessage(I,J('collapseAll'))},toggleDebugWindow:function(){G(l.toggleDebugWindow())},createCustomCompile:function(a){G(l.setCustomCompile({show:a,id:-1}))},switchToMiniProgramDev:function(){H().window.mainWindow===f.MAIN_WINDOW_TYPE.WEB_DEBUGGER&&B.switchToMiniProgramDev()&&b()},switchToWebDev:function(){H().window.mainWindow===f.MAIN_WINDOW_TYPE.DEV&&B.switchToWebDev()&&G(m.closeProject())},back:function(){G(z.setActions('back'))},forward:function(){G(z.setActions('forward'))},focusAddress:function(){G(z.setActions('focusAddress'))},refresh:function(){G(z.setActions('reload'))},selectAll:function(){c('selectAll')},jumpQCloudPage:async function(a){try{const{body:b}=await v({url:t.gettmpcode,needToken:1,needAppID:1});a=0<a.indexOf('?')?`${a}&tmpcode=${b.tmp_code}`:`${a}?tmpcode=${b.tmp_code}`,nw.Shell.openExternal(a)}catch(a){G(i.showError(a.toString()))}},toggleToolbar:function(){G(l.toggleToolbar())},toggleMiniMode:function(){global.onlySimulator=!global.onlySimulator},clearWebviewCache:function(){G(n.cleanWebViewCache())},clearSession:function(){G(n.clearSession())},clearAllCache:function(){G(n.cleanAll())},toggleCos:function(){G(p.openCosManager())},toolsManager:function(){G(n.toggleClickKey(y.TOOLBARCONFIGLIST))},jumpTGit:function(){G(n.jumpTGit())},showMultiAccountBox:function(){G(l.setMultiAccountBox({show:!0})),F('multi_account_debugging',!0)},openPlugin:function(a){G(l.setPluginPopUpWindow({pluginId:a,show:!0}))},changeLocale:function(a){G(o.updateIDESetting('appearance','locale',a))},jumpWXGit:function(){G(n.jumpWXGit())},showPluginWindow:function(){G(r.togglePanelVisibility())}}}(require('lazyload'),require);