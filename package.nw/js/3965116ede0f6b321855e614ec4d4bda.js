;!function(require, directRequire){;"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const path=require("path"),crypto=require("crypto"),store=require('./bc78839ccca8df9e5ceeb7fae11b7be2.js'),SIMULATOR_TYPE=require('./efd8b4323f89b2a759d044d894e3a4f0.js'),C=require('./56c390e04c10e91a4aa2a2c19d9a885d.js'),consoleDisplay=require('./2dfc6a3df6d6fc51266b293c8420e88b.js'),signature=require('./c3cff51847d72be47e57256891296359.js'),dirConfig=require('./92320c1386e6db6a6f2556736a9bc280.js'),{fsReadFileAsync,unpackBuffer}=require('./7edfbc4174278f63f29a7698216c9306.js'),isDev=global.appConfig.isDev,vendorPluginRoot=dirConfig.WeappPlugin,cache=new Map;async function getSimulatorPluginWAFile(a){if(["hls.js","WARemoteDebug.js","devtools-native-components.js"].includes(a))return{preventDefault:!1};const b=store.getState(),c=b.project.current,d=c.simulatorType,e=b.plugin.pluginManifests[d];if(!e)return{preventDefault:!1};const f=e.libs;if(!f||0===Object.keys(f).length)return{preventDefault:!1};if(d!==SIMULATOR_TYPE.wechat&&e.simulator&&0<Object.keys(f).length){const b=c.simulatorPluginLibVersion[d];if(!f[b])return{preventDefault:!1};a=0===a.indexOf("/")?a:`/${a}`;const g=cache.get(d);if(!isDev&&g&&g.has(b)&&g.get(b).has(a))return{file:g.get(b).get(a),preventDefault:!0};const h=e.libsPath,i=e.publicKey||"",j=f[b]||{},k=path.join(vendorPluginRoot,d,h,b,`${b}.wxvpkg`),l=await fsReadFileAsync(k),m=crypto.createHash("md5");m.update(l);const n=m.digest("hex");if(!signature.checkSignature(n,j.signature,i))return consoleDisplay.display({command:C.DISPLAY_ERROR,data:{title:"\u57FA\u7840\u5E93 md5 \u6821\u9A8C\u5931\u8D25",error:{message:"\u6A21\u62DF\u5668\u63D2\u4EF6\u5B9A\u5236\u7684\u57FA\u7840\u5E93 \u4E0E manifest \u91CC\u7684 publicKey (md5) \u4E0D\u5339\u914D"}}}),{preventDefault:!1};const o=await unpackBuffer(l);o.set("version",b);const p=o.get(a);if(p)return cache.has(d)||cache.set(d,new Map),cache.get(d).set(b,o),{file:p,preventDefault:!0}}return{preventDefault:!1}}module.exports={getSimulatorPluginWAFile};
;}(require("lazyload"), require);
