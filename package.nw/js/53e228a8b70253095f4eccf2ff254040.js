;!function(require, directRequire){;"use strict";const fs=require("fs"),INFO_LENGTH_BEGIN=5,INFO_LENGTH_END=9,FILE_COUNT_BEGIN=14,FILE_COUNT_END=18,FILF_INFO_BEGIN=18;class WxvpkgReader{constructor(a){this.fileMap={},this.cache={},this._close=!1,this.readSync=(a,b)=>{if(this._close)return Buffer.alloc(0);const c=Buffer.alloc(b-a);return fs.readSync(this.fd,c,0,b-a,a),c},this.fd=fs.openSync(a);const b=this.readSync(FILE_COUNT_BEGIN,FILE_COUNT_END).readInt32BE(0);console.log(b),this.fileMap=this.getFileMap(b)}getFileMap(a){const b={};let c=FILF_INFO_BEGIN;for(let d=0;d<a;d++){const a={},d=this.readSync(c,c+4).readInt32BE(0);c+=4,a.name=this.readSync(c,c+d).toString(),c+=d,a.offset=this.readSync(c,c+4).readInt32BE(0),c+=4,a.length=this.readSync(c,c+4).readInt32BE(0),c+=4,b[a.name]=a}return b}getFile(a){if(!this.cache[a]){const b=this.fileMap[a];this.cache[a]=b?this.readSync(b.offset,b.length):Buffer.alloc(0)}return this.cache[a]}exists(a){return!!this.fileMap[a]}close(){this._close||(fs.close(this.fd),this.fd=void 0),this._close=!0}}module.exports=WxvpkgReader;
;}(require("lazyload"), require);
