;!function(require, directRequire){;'use strict';const React=require('react'),{Provider}=require('react-redux'),store=require('./bc78839ccca8df9e5ceeb7fae11b7be2.js'),WindowRegistry=require('./db2217eb4cff896bdcbc50abe005058f.js'),ReactDOM=require('react-dom');class DummyComponent extends React.Component{constructor(a){super(a),this.state={mount:!0}}render(){return this.state.mount?React.createElement('div',Object.assign({},this.props,{style:{width:'100%',height:'100%'}}),this.props.children):React.createElement('div',null)}}module.exports=class extends React.Component{constructor(a){super(a),this.registryId='',this.onMessage=(a)=>{this.props.onMessage&&this.props.onMessage(a)}}componentDidMount(){window.addEventListener('message',this.onMessage),this.openWindow(this.props.url)}componentWillReceiveProps(a){a.url!==this.props.url&&this.child&&(this.props.webview?this.setupWebview(a.url):this.child.window.location.href=a.url)}componentWillUnmount(){this.unmounted=!0,this.closeWindow(),window.removeEventListener('message',this.onMessage)}openWindow(a){const b=this.props.webview?'html/iframe.html':a;nw.Window.open(b,this.getWindowOptions(),(a)=>{if(this.unmounted)return void a.close(!0);this.registryId=this.props.registryId,this.child=a,a.on('close',()=>{setTimeout(this.closeWindow.bind(this),100),this.props.onWindowClose&&this.props.onWindowClose(a)}),a.on('new-win-policy',(a,b,c)=>{console.log(a,b,c),c.forceCurrent()}),this.props.onWindowOpen&&this.props.onWindowOpen(a),this.registryId&&(WindowRegistry.register({id:this.registryId,window:a}),global.windowMap.set(this.registryId,a));const b=a.window;'complete'===b.document.readyState?this.onDocumentReady():b.window.document.addEventListener('DOMContentLoaded',this.onDocumentReady.bind(this),!1)})}onDocumentReady(){this.props.onDocumentReady&&this.props.onDocumentReady(),this.props.webview&&this.props.url&&this.setupWebview(this.props.url)}setupWebview(a){if(this.webview||(this.webview=this.child.window.document.getElementById('webview')),this.webview.src=a,this.props.children){const a=document.createElement('div');this.child.window.document.body.appendChild(a),ReactDOM.render(React.createElement(Provider,{store:store},'// @ts-ignore',React.createElement(DummyComponent,Object.assign({ref:(a)=>this.dummy=a},this.props.wrapperProps),this.props.children)),a)}}closeWindow(){try{this.child&&(this.registryId&&WindowRegistry.unregister(this.registryId),this.child.close(!0),this.child=void 0)}catch(a){}}getWindowOptions(){return function(a){const b={};for(const c of a)this.props.hasOwnProperty(c)&&(b[c]=this.props[c]);return b}.bind(this)(['id','title','icon','position','always_on_top','width','height','min_width','min_height','max_width','max_height','resizable','kiosk','fullscreen','show_in_taskbar','frame','transparent'])}render(){return React.createElement('div',{style:{display:'none'}})}};
;}(require("lazyload"), require);
