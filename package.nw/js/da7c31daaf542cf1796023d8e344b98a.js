;!function(require, directRequire){;'use strict';const request=require('./15ba1827c7f6564a45df6bd44da3a977.js'),urlConfig=require('./f171257bbcaef547a3cf27266ccb0db2.js'),nameToType=require('./bd8013ddc05ec46748b69a50cb442520.js'),projectManager=require('./3bfffbe88b3d923921f851c0697974fe.js'),REPORT_TIME=300000,MAX_TIMES=10;let queue={};const extraInfo={};let currentAPPID;function post(a,b){const c=b?`${urlConfig.newReportURL}?haveappid=1&appid=${b}`:`${urlConfig.newReportURL}?haveappid=0`,d={url:c,forceLogin:-1,body:JSON.stringify({client_useinfo:a,client_time:Math.floor(Date.now()/1e3)}),method:'post',needToken:1,needCheckErrCode:-1};request(d).then(()=>{}).catch(()=>{})}function getPData(a){const b=[];for(const c in a)for(const d in a[c])'DEFAULT'==d?b.push({type:nameToType[c],times:a[c].DEFAULT.times}):b.push(Object.assign({},a[c][d].extraFields,{type:nameToType[c],times:a[c][d].times}));return b}function reportData(a,b,c){const d=[];d.push({type:nameToType[a],times:1,data:c}),post(d,b)}function reportType(){for(const a in queue){const b=getPData(queue[a]);let c='';'noappid'!=a&&(c=a),0<b.length&&post(b,c)}queue={}}async function report(a,b,c,d){if(global.appConfig.isDev)return void console.log('report',a,b,c,d);let e;if(!0===b){const a=projectManager.getCurrent()||{};e=a.appid}else'string'==typeof b&&(e=b);if(c)return void reportData(a,e,c);if(e&&void 0!=currentAPPID&&e!==currentAPPID&&reportType(),e?currentAPPID=e:e='noappid',queue[e]||(queue[e]={}),queue[e][a]||(queue[e][a]={DEFAULT:{times:0}}),!d)queue[e][a].DEFAULT.times++,queue[e][a].DEFAULT.times>=MAX_TIMES&&reportType();else{const b=JSON.stringify(d);queue[e][a][b]||(queue[e][a][b]={extraFields:d,times:0}),queue[e][a][b].times++,queue[e][a][b].times>=MAX_TIMES&&reportType()}}setInterval(()=>{reportType()},REPORT_TIME),global.Win.on('close',()=>{reportType()}),module.exports=report;
;}(require("lazyload"), require);
